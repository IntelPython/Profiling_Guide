<!DOCTYPE html>
<head>
<meta charset="UTF-8">
<style>
.r1 {color: #005f00; text-decoration-color: #005f00}
.r2 {font-weight: bold}
.r3 {color: #000080; text-decoration-color: #000080; font-weight: bold}
.r4 {color: #87af00; text-decoration-color: #87af00; font-weight: bold}
.r5 {color: #005f00; text-decoration-color: #005f00; font-weight: bold}
.r6 {color: #7f7f7f; text-decoration-color: #7f7f7f; font-weight: bold}
.r7 {color: #000080; text-decoration-color: #000080; font-weight: bold; font-style: italic}
.r8 {color: #87af00; text-decoration-color: #87af00; font-weight: bold; font-style: italic}
.r9 {color: #005f00; text-decoration-color: #005f00; font-weight: bold; font-style: italic}
.r10 {color: #7f7f7f; text-decoration-color: #7f7f7f}
.r11 {color: #000080; text-decoration-color: #000080}
.r12 {color: #87af00; text-decoration-color: #87af00}
.r13 {color: #3d7b7b; text-decoration-color: #3d7b7b; background-color: #f8f8f8; font-style: italic}
.r14 {background-color: #f8f8f8}
.r15 {color: #ba2121; text-decoration-color: #ba2121; background-color: #f8f8f8; font-style: italic}
.r16 {color: #008000; text-decoration-color: #008000; background-color: #f8f8f8; font-weight: bold}
.r17 {color: #000000; text-decoration-color: #000000; background-color: #f8f8f8}
.r18 {color: #0000ff; text-decoration-color: #0000ff; background-color: #f8f8f8; font-weight: bold}
.r19 {color: #0000ff; text-decoration-color: #0000ff; background-color: #f8f8f8}
.r20 {color: #bbbbbb; text-decoration-color: #bbbbbb; background-color: #f8f8f8}
.r21 {color: #666666; text-decoration-color: #666666; background-color: #f8f8f8}
.r22 {color: #ba2121; text-decoration-color: #ba2121; background-color: #f8f8f8}
.r23 {color: #008000; text-decoration-color: #008000; background-color: #f8f8f8}
.r24 {color: #aa22ff; text-decoration-color: #aa22ff; background-color: #f8f8f8; font-weight: bold}
.r25 {color: #a45a77; text-decoration-color: #a45a77; background-color: #f8f8f8; font-weight: bold}
.r26 {color: #19177c; text-decoration-color: #19177c; background-color: #f8f8f8}
.r27 {font-weight: bold; font-style: italic}
.r28 {font-style: italic}
.r29 {color: #000080; text-decoration-color: #000080; text-decoration: underline}
body {
    color: #000000;
    background-color: #ffffff;
}
</style>
</head>
<html>
<body>
    <pre style="font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><code>                            Memory usage: <span class="r1">█████████████████████████</span> (max: 101.16MB, growth rate:  21%)                             
                                      run_benchmarks.py: % of time =  94.33% out of  23.20s.                                       
       ╷       ╷       ╷       ╷       ╷       ╷       ╷              ╷       ╷                                                    
 <span class="r2">      </span>│<span class="r3">Time</span><span class="r2">   </span>│<span class="r3">––––––</span><span class="r2"> </span>│<span class="r3">––––––</span><span class="r2"> </span>│<span class="r4">––––––</span><span class="r2"> </span>│<span class="r5">Memory</span><span class="r2"> </span>│<span class="r5">––––––</span><span class="r2"> </span>│<span class="r5">–––––––––––</span><span class="r2">   </span>│<span class="r4">Copy</span><span class="r2">   </span>│<span class="r2">                                                   </span> 
 <span class="r2"> </span><span class="r6">Line</span><span class="r2"> </span>│<span class="r7">Python</span><span class="r2"> </span>│<span class="r7">native</span><span class="r2"> </span>│<span class="r7">system</span><span class="r2"> </span>│<span class="r8">GPU</span><span class="r2">    </span>│<span class="r9">Python</span><span class="r2"> </span>│<span class="r9">net</span><span class="r2">    </span>│<span class="r9">timeline</span><span class="r5">/%</span><span class="r2">    </span>│<span class="r8">(MB/s)</span><span class="r2"> </span>│<span class="r2">run_benchmarks.py                                  </span> 
╺━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━━━━━━━━┿━━━━━━━┿━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸
 <span class="r10">    1 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r13"># !/usr/bin/env python3</span><span class="r14">                           </span>  
 <span class="r10">    2 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r13"># -*- coding: utf-8 -*-</span><span class="r14">                           </span>  
 <span class="r10">    3 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">    4 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r13"># Copyright (C) 2022 Intel Corporation</span><span class="r14">            </span>  
 <span class="r10">    5 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r13"># SPDX-License-Identifier: BSD-3-Clause</span><span class="r14">           </span>  
 <span class="r10">    6 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">    7 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r13"># pylint: disable=C0415,E0401,R0914</span><span class="r14">               </span>  
 <span class="r10">    8 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">    9 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">&quot;&quot;&quot;</span><span class="r14">                                               </span>  
 <span class="r10">   10 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">Run benchmarks for Intelligent Indexing.</span><span class="r14">          </span>  
 <span class="r10">   11 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">&quot;&quot;&quot;</span><span class="r14">                                               </span>  
 <span class="r10">   12 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   13 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r16">import</span><span class="r17"> </span><span class="r18">argparse</span><span class="r14">                                   </span>  
 <span class="r10">   14 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r16">import</span><span class="r17"> </span><span class="r18">logging</span><span class="r14">                                    </span>  
 <span class="r10">   15 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r16">import</span><span class="r17"> </span><span class="r18">os</span><span class="r14">                                         </span>  
 <span class="r10">   16 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r16">import</span><span class="r17"> </span><span class="r18">pathlib</span><span class="r14">                                    </span>  
 <span class="r10">   17 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r16">import</span><span class="r17"> </span><span class="r18">time</span><span class="r14">                                       </span>  
 <span class="r10">   18 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   19 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">  10%  </span>│<span class="r1">   10M </span>│<span class="r1">▁▁▁▁▁▁▁  10%  </span>│<span class="r12">       </span>│<span class="r16">import</span><span class="r17"> </span><span class="r18">joblib</span><span class="r14">                                     </span>  
 <span class="r10">   20 </span>│<span class="r11">    2% </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">  27%  </span>│<span class="r1">   24M </span>│<span class="r1">▁▁▁▁▁  28%    </span>│<span class="r12">     2 </span>│<span class="r16">from</span><span class="r17"> </span><span class="r18">sklearn.feature_extraction.text</span><span class="r17"> </span><span class="r16">import</span><span class="r17"> TfidfV</span>  
 <span class="r10">   21 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">    1M </span>│<span class="r1">▁▁▁▁▁         </span>│<span class="r12">       </span>│<span class="r16">from</span><span class="r17"> </span><span class="r18">sklearn.metrics</span><span class="r17"> </span><span class="r16">import</span><span class="r17"> accuracy_score</span><span class="r14">        </span>  
 <span class="r10">   22 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   23 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">    0M </span>│<span class="r1">▁▁            </span>│<span class="r12">       </span>│<span class="r16">from</span><span class="r17"> </span><span class="r18">utils.preprocessing</span><span class="r17"> </span><span class="r16">import</span><span class="r17"> (</span><span class="r14">                 </span>  
 <span class="r10">   24 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    clean_headline,</span><span class="r14">                               </span>  
 <span class="r10">   25 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    clean_link,</span><span class="r14">                                   </span>  
 <span class="r10">   26 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    clean_short_description,</span><span class="r14">                      </span>  
 <span class="r10">   27 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    tokenize</span><span class="r14">                                      </span>  
 <span class="r10">   28 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">)</span><span class="r14">                                                 </span>  
 <span class="r10">   29 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r16">from</span><span class="r17"> </span><span class="r18">scalene</span><span class="r17"> </span><span class="r16">import</span><span class="r17"> scalene_profiler</span><span class="r14">              </span>  
 <span class="r10">   30 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   31 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   32 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   33 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r16">def</span><span class="r17"> </span><span class="r19">main</span><span class="r17">(flags):</span><span class="r14">                                  </span>  
 <span class="r10">   34 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r20">    </span><span class="r15">&quot;&quot;&quot;Setup model for inference and perform bench</span>  
 <span class="r10">   35 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   36 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">    Args:</span><span class="r14">                                         </span>  
 <span class="r10">   37 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">        flags: benchmarking flags</span><span class="r14">                 </span>  
 <span class="r10">   38 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">    &quot;&quot;&quot;</span><span class="r14">                                           </span>  
 <span class="r10">   39 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   40 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    </span><span class="r16">if</span><span class="r17"> flags</span><span class="r21">.</span><span class="r17">logfile </span><span class="r21">==</span><span class="r17"> </span><span class="r22">&quot;&quot;</span><span class="r17">:</span><span class="r14">                       </span>  
 <span class="r10">   41 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        logging</span><span class="r21">.</span><span class="r17">basicConfig(level</span><span class="r21">=</span><span class="r17">logging</span><span class="r21">.</span><span class="r17">DEBUG)</span><span class="r14">  </span>  
 <span class="r10">   42 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    </span><span class="r16">else</span><span class="r17">:</span><span class="r14">                                         </span>  
 <span class="r10">   43 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        logging</span><span class="r21">.</span><span class="r17">basicConfig(filename</span><span class="r21">=</span><span class="r17">flags</span><span class="r21">.</span><span class="r17">logfile</span>  
 <span class="r10">   44 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    logger </span><span class="r21">=</span><span class="r17"> logging</span><span class="r21">.</span><span class="r17">getLogger()</span><span class="r14">                  </span>  
 <span class="r10">   45 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   46 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    </span><span class="r16">if</span><span class="r17"> flags</span><span class="r21">.</span><span class="r17">intel:</span><span class="r14">                               </span>  
 <span class="r10">   47 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        logging</span><span class="r21">.</span><span class="r17">debug(</span><span class="r22">&quot;Loading intel libraries...&quot;</span>  
 <span class="r10">   48 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   49 </span>│<span class="r11">    1% </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">  18%  </span>│<span class="r1">   24M </span>│<span class="r1">▂▂▂▂▂▂▂  18%  </span>│<span class="r12">     1 </span>│<span class="r17">        </span><span class="r16">import</span><span class="r17"> </span><span class="r18">modin.pandas</span><span class="r17"> </span><span class="r16">as</span><span class="r17"> </span><span class="r18">pd</span><span class="r14">                 </span>  
 <span class="r10">   50 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">   6%  </span>│<span class="r1">    6M </span>│<span class="r1">▁▁▁▁▁   6%    </span>│<span class="r12">       </span>│<span class="r17">        </span><span class="r16">from</span><span class="r17"> </span><span class="r18">sklearnex.svm</span><span class="r17"> </span><span class="r16">import</span><span class="r17"> SVC</span><span class="r14">             </span>  
 <span class="r10">   51 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">  13%  </span>│<span class="r1">   15M </span>│<span class="r1">▁▁▁▁  13%     </span>│<span class="r12">       </span>│<span class="r17">        </span><span class="r16">import</span><span class="r17"> </span><span class="r18">ray</span><span class="r14">                                </span>  
 <span class="r10">   52 </span>│<span class="r11">    1% </span>│<span class="r11">       </span>│<span class="r11">  87%  </span>│<span class="r12">       </span>│<span class="r1">   2%  </span>│<span class="r1">    0M </span>│<span class="r1">▁▁▁▁▁▁▁▁▁   … </span>│<span class="r12">       </span>│<span class="r17">        ray</span><span class="r21">.</span><span class="r17">init()</span><span class="r14">                                </span>  
 <span class="r10">   53 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   54 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    </span><span class="r16">else</span><span class="r17">:</span><span class="r14">                                         </span>  
 <span class="r10">   55 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        logging</span><span class="r21">.</span><span class="r17">debug(</span><span class="r22">&quot;Loading stock libraries...&quot;</span>  
 <span class="r10">   56 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   57 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        </span><span class="r16">import</span><span class="r17"> </span><span class="r18">pandas</span><span class="r17"> </span><span class="r16">as</span><span class="r17"> </span><span class="r18">pd</span><span class="r14">                       </span>  
 <span class="r10">   58 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        </span><span class="r16">from</span><span class="r17"> </span><span class="r18">sklearn.svm</span><span class="r17"> </span><span class="r16">import</span><span class="r17"> SVC</span><span class="r14">               </span>  
 <span class="r10">   59 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   60 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    </span><span class="r16">def</span><span class="r17"> </span><span class="r19">get_data</span><span class="r17">(path_to_csv: </span><span class="r23">str</span><span class="r17">) </span><span class="r21">-&gt;</span><span class="r17"> pd</span><span class="r21">.</span><span class="r17">DataFrame</span>  
 <span class="r10">   61 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r20">        </span><span class="r15">&quot;&quot;&quot;Read in and clean data</span><span class="r14">                 </span>  
 <span class="r10">   62 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   63 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">        Args:</span><span class="r14">                                     </span>  
 <span class="r10">   64 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">            path_to_csv (str): processed data</span><span class="r14">     </span>  
 <span class="r10">   65 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">        &quot;&quot;&quot;</span><span class="r14">                                       </span>  
 <span class="r10">   66 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        data </span><span class="r21">=</span><span class="r17"> pd</span><span class="r21">.</span><span class="r17">read_csv(path_to_csv)[</span><span class="r14">          </span>  
 <span class="r10">   67 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">            [</span><span class="r22">&#x27;category&#x27;</span><span class="r17">, </span><span class="r22">&#x27;headline&#x27;</span><span class="r17">, </span><span class="r22">&#x27;short_descri</span>  
 <span class="r10">   68 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        ]</span><span class="r14">                                         </span>  
 <span class="r10">   69 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        data </span><span class="r21">=</span><span class="r17"> data</span><span class="r21">.</span><span class="r17">dropna(subset</span><span class="r21">=</span><span class="r17">[</span><span class="r22">&#x27;headline&#x27;</span><span class="r17">, </span><span class="r22">&#x27;sh</span>  
 <span class="r10">   70 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   71 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        data</span><span class="r21">.</span><span class="r17">link </span><span class="r21">=</span><span class="r17"> data</span><span class="r21">.</span><span class="r17">link</span><span class="r21">.</span><span class="r17">apply(clean_link)</span><span class="r14">   </span>  
 <span class="r10">   72 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        data</span><span class="r21">.</span><span class="r17">short_description </span><span class="r21">=</span><span class="r17"> data</span><span class="r21">.</span><span class="r17">short_descri</span>  
 <span class="r10">   73 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">            </span><span class="r21">.</span><span class="r17">apply(clean_short_description)</span><span class="r14">       </span>  
 <span class="r10">   74 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        data</span><span class="r21">.</span><span class="r17">headline </span><span class="r21">=</span><span class="r17"> data</span><span class="r21">.</span><span class="r17">headline</span><span class="r21">.</span><span class="r17">apply(clean_</span>  
 <span class="r10">   75 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   76 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        data[</span><span class="r22">&#x27;text&#x27;</span><span class="r17">] </span><span class="r21">=</span><span class="r17"> data</span><span class="r21">.</span><span class="r17">link </span><span class="r21">+</span><span class="r17"> </span><span class="r22">&quot; &quot;</span><span class="r17"> </span><span class="r21">+</span><span class="r17"> data</span><span class="r21">.</span><span class="r17">shor</span>  
 <span class="r10">   77 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">            </span><span class="r21">+</span><span class="r17"> </span><span class="r22">&quot; &quot;</span><span class="r17"> </span><span class="r21">+</span><span class="r17"> data</span><span class="r21">.</span><span class="r17">headline</span><span class="r14">                 </span>  
 <span class="r10">   78 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        data[</span><span class="r22">&#x27;tokens&#x27;</span><span class="r17">] </span><span class="r21">=</span><span class="r17"> data</span><span class="r21">.</span><span class="r17">text</span><span class="r21">.</span><span class="r17">apply(tokenize)</span>  
 <span class="r10">   79 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        </span><span class="r16">return</span><span class="r17"> data</span><span class="r14">                               </span>  
 <span class="r10">   80 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   81 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    scalene_profiler</span><span class="r21">.</span><span class="r17">start()</span><span class="r14">                      </span>  
 <span class="r10">   82 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    </span><span class="r13"># Read and clean training and testing data</span><span class="r14">    </span>  
 <span class="r10">   83 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    logger</span><span class="r21">.</span><span class="r17">info(</span><span class="r22">&quot;Preprocessing Data...&quot;</span><span class="r17">)</span><span class="r14">          </span>  
 <span class="r10">   84 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    start </span><span class="r21">=</span><span class="r17"> time</span><span class="r21">.</span><span class="r17">time()</span><span class="r14">                           </span>  
 <span class="r10">   85 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   86 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    </span><span class="r16">if</span><span class="r17"> </span><span class="r24">not</span><span class="r17"> os</span><span class="r21">.</span><span class="r17">path</span><span class="r21">.</span><span class="r17">exists(</span><span class="r22">&quot;../data/huffpost/train_</span>  
 <span class="r10">   87 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        logger</span><span class="r21">.</span><span class="r17">error(</span><span class="r14">                             </span>  
 <span class="r10">   88 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">            </span><span class="r22">&quot;Train data file ../data/huffpost/trai</span>  
 <span class="r10">   89 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        </span><span class="r16">return</span><span class="r14">                                    </span>  
 <span class="r10">   90 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   91 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    </span><span class="r16">if</span><span class="r17"> </span><span class="r24">not</span><span class="r17"> os</span><span class="r21">.</span><span class="r17">path</span><span class="r21">.</span><span class="r17">exists(</span><span class="r22">&quot;../data/huffpost/test.c</span>  
 <span class="r10">   92 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        logger</span><span class="r21">.</span><span class="r17">error(</span><span class="r22">&quot;Test data file ../data/huffp</span>  
 <span class="r10">   93 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        </span><span class="r16">return</span><span class="r14">                                    </span>  
 <span class="r10">   94 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   95 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    train </span><span class="r21">=</span><span class="r17"> get_data(</span><span class="r22">&quot;../data/huffpost/train_all.c</span>  
 <span class="r10">   96 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    test </span><span class="r21">=</span><span class="r17"> get_data(</span><span class="r22">&quot;../data/huffpost/test.csv&quot;</span><span class="r17">)</span><span class="r14">  </span>  
 <span class="r10">   97 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   98 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    preprocessing_time </span><span class="r21">=</span><span class="r17"> time</span><span class="r21">.</span><span class="r17">time()</span><span class="r14">              </span>  
 <span class="r10">   99 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    logger</span><span class="r21">.</span><span class="r17">info(</span><span class="r14">                                  </span>  
 <span class="r10">  100 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        </span><span class="r22">&quot;=======&gt; Preprocessing Time : </span><span class="r25">%.3f</span><span class="r22"> secs&quot;</span><span class="r17">,</span>  
 <span class="r10">  101 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        preprocessing_time </span><span class="r21">-</span><span class="r17"> start</span><span class="r14">                </span>  
 <span class="r10">  102 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    )</span><span class="r14">                                             </span>  
 <span class="r10">  103 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">  104 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    </span><span class="r16">if</span><span class="r17"> </span><span class="r24">not</span><span class="r17"> flags</span><span class="r21">.</span><span class="r17">preprocessing_only:</span><span class="r14">              </span>  
 <span class="r10">  105 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">  106 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        </span><span class="r13"># Build TFIDF features and train the model</span>  
 <span class="r10">  107 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        logger</span><span class="r21">.</span><span class="r17">debug(</span><span class="r22">&quot;Training &amp; Evaluating Model.</span>  
 <span class="r10">  108 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">  109 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        vectorizer </span><span class="r21">=</span><span class="r17"> TfidfVectorizer(</span><span class="r14">             </span>  
 <span class="r10">  110 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">            min_df</span><span class="r21">=50</span><span class="r17">,</span><span class="r14">                            </span>  
 <span class="r10">  111 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">            lowercase</span><span class="r21">=</span><span class="r16">False</span><span class="r17">,</span><span class="r14">                      </span>  
 <span class="r10">  112 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">            tokenizer</span><span class="r21">=</span><span class="r16">lambda</span><span class="r17"> x: x)</span><span class="r14">                </span>  
 <span class="r10">  113 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">  114 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        svc </span><span class="r21">=</span><span class="r17"> SVC()</span><span class="r14">                               </span>  
 <span class="r10">  115 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        svc</span><span class="r21">.</span><span class="r17">fit(vectorizer</span><span class="r21">.</span><span class="r17">fit_transform(train</span><span class="r21">.</span><span class="r17">tok</span>  
 <span class="r10">  116 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">  117 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        training_time </span><span class="r21">=</span><span class="r17"> time</span><span class="r21">.</span><span class="r17">time()</span><span class="r14">               </span>  
 <span class="r10">  118 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">  119 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        </span><span class="r13"># Predict on unseen test data</span><span class="r14">             </span>  
 <span class="r10">  120 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        y_pred </span><span class="r21">=</span><span class="r17"> svc</span><span class="r21">.</span><span class="r17">predict(vectorizer</span><span class="r21">.</span><span class="r17">transform(</span>  
 <span class="r10">  121 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">  122 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        prediction_time </span><span class="r21">=</span><span class="r17"> time</span><span class="r21">.</span><span class="r17">time()</span><span class="r14">             </span>  
 <span class="r10">  123 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">  124 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        </span><span class="r16">if</span><span class="r17"> flags</span><span class="r21">.</span><span class="r17">save_model_dir:</span><span class="r14">                  </span>  
 <span class="r10">  125 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">  126 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">            path </span><span class="r21">=</span><span class="r17"> pathlib</span><span class="r21">.</span><span class="r17">Path(flags</span><span class="r21">.</span><span class="r17">save_model_d</span>  
 <span class="r10">  127 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">            path</span><span class="r21">.</span><span class="r17">mkdir(parents</span><span class="r21">=</span><span class="r16">True</span><span class="r17">, exist_ok</span><span class="r21">=</span><span class="r16">True</span>  
 <span class="r10">  128 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">  129 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">            </span><span class="r16">with</span><span class="r17"> </span><span class="r23">open</span><span class="r17">(path </span><span class="r21">/</span><span class="r17"> </span><span class="r22">&quot;model.pkl&quot;</span><span class="r17">, </span><span class="r22">&#x27;wb&#x27;</span><span class="r17">) </span><span class="r16">as</span>  
 <span class="r10">  130 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                joblib</span><span class="r21">.</span><span class="r17">dump(svc, outfile)</span><span class="r14">         </span>  
 <span class="r10">  131 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">  132 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        logger</span><span class="r21">.</span><span class="r17">info(</span><span class="r14">                              </span>  
 <span class="r10">  133 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">            </span><span class="r22">&quot;=======&gt; Test Accuracy : </span><span class="r25">%.2f</span><span class="r22">&quot;</span><span class="r17">,</span><span class="r14">      </span>  
 <span class="r10">  134 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">            accuracy_score(y_pred, test</span><span class="r21">.</span><span class="r17">category)</span><span class="r14"> </span>  
 <span class="r10">  135 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        )</span><span class="r14">                                         </span>  
 <span class="r10">  136 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        logger</span><span class="r21">.</span><span class="r17">info(</span><span class="r14">                              </span>  
 <span class="r10">  137 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">            </span><span class="r22">&quot;=======&gt; Training Time : </span><span class="r25">%.3f</span><span class="r22"> secs&quot;</span><span class="r17">,</span><span class="r14"> </span>  
 <span class="r10">  138 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">            training_time </span><span class="r21">-</span><span class="r17"> preprocessing_time</span><span class="r14">    </span>  
 <span class="r10">  139 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        )</span><span class="r14">                                         </span>  
 <span class="r10">  140 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        logger</span><span class="r21">.</span><span class="r17">info(</span><span class="r14">                              </span>  
 <span class="r10">  141 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">            </span><span class="r22">&quot;=======&gt; Inference Time : </span><span class="r25">%.3f</span><span class="r22"> secs&quot;</span><span class="r17">,</span>  
 <span class="r10">  142 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">            prediction_time </span><span class="r21">-</span><span class="r17"> training_time</span><span class="r14">       </span>  
 <span class="r10">  143 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        )</span><span class="r14">                                         </span>  
 <span class="r10">  144 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        logger</span><span class="r21">.</span><span class="r17">info(</span><span class="r14">                              </span>  
 <span class="r10">  145 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">            </span><span class="r22">&quot;=======&gt; Total time : </span><span class="r25">%.3f</span><span class="r22"> secs&quot;</span><span class="r17">,</span><span class="r14">    </span>  
 <span class="r10">  146 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">            prediction_time </span><span class="r21">-</span><span class="r17"> start</span><span class="r14">               </span>  
 <span class="r10">  147 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        )</span><span class="r14">                                         </span>  
 <span class="r10">  148 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    scalene_profiler</span><span class="r21">.</span><span class="r17">stop()</span><span class="r14">                       </span>  
 <span class="r10">  149 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">  150 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r16">if</span><span class="r17"> </span><span class="r26">__name__</span><span class="r17"> </span><span class="r21">==</span><span class="r17"> </span><span class="r22">&quot;__main__&quot;</span><span class="r17">:</span><span class="r14">                        </span>  
 <span class="r10">  151 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">  152 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    parser </span><span class="r21">=</span><span class="r17"> argparse</span><span class="r21">.</span><span class="r17">ArgumentParser()</span><span class="r14">            </span>  
 <span class="r10">  153 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">  154 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    parser</span><span class="r21">.</span><span class="r17">add_argument(</span><span class="r22">&#x27;-l&#x27;</span><span class="r17">,</span><span class="r14">                     </span>  
 <span class="r10">  155 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        </span><span class="r22">&#x27;--logfile&#x27;</span><span class="r17">,</span><span class="r14">              </span>  
 <span class="r10">  156 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        </span><span class="r23">type</span><span class="r21">=</span><span class="r23">str</span><span class="r17">,</span><span class="r14">                 </span>  
 <span class="r10">  157 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        default</span><span class="r21">=</span><span class="r22">&quot;&quot;</span><span class="r17">,</span><span class="r14">               </span>  
 <span class="r10">  158 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        help</span><span class="r21">=</span><span class="r22">&quot;log file to output b</span>  
 <span class="r10">  159 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">  160 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    parser</span><span class="r21">.</span><span class="r17">add_argument(</span><span class="r22">&#x27;-i&#x27;</span><span class="r17">,</span><span class="r14">                     </span>  
 <span class="r10">  161 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        </span><span class="r22">&#x27;--intel&#x27;</span><span class="r17">,</span><span class="r14">                </span>  
 <span class="r10">  162 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        default</span><span class="r21">=</span><span class="r16">False</span><span class="r17">,</span><span class="r14">            </span>  
 <span class="r10">  163 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        action</span><span class="r21">=</span><span class="r22">&quot;store_true&quot;</span><span class="r17">,</span><span class="r14">      </span>  
 <span class="r10">  164 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        help</span><span class="r21">=</span><span class="r22">&quot;use intel accelerate</span>  
 <span class="r10">  165 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        )</span><span class="r14">                         </span>  
 <span class="r10">  166 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">  167 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    parser</span><span class="r21">.</span><span class="r17">add_argument(</span><span class="r22">&#x27;-p&#x27;</span><span class="r17">,</span><span class="r14">                     </span>  
 <span class="r10">  168 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        </span><span class="r22">&#x27;--preprocessing_only&#x27;</span><span class="r17">,</span><span class="r14">   </span>  
 <span class="r10">  169 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        default</span><span class="r21">=</span><span class="r16">False</span><span class="r17">,</span><span class="r14">            </span>  
 <span class="r10">  170 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        action</span><span class="r21">=</span><span class="r22">&quot;store_true&quot;</span><span class="r17">,</span><span class="r14">      </span>  
 <span class="r10">  171 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        help</span><span class="r21">=</span><span class="r22">&#x27;only perform preproc</span>  
 <span class="r10">  172 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">  173 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    parser</span><span class="r21">.</span><span class="r17">add_argument(</span><span class="r22">&#x27;-s&#x27;</span><span class="r17">,</span><span class="r14">                     </span>  
 <span class="r10">  174 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        </span><span class="r22">&#x27;--save_model_dir&#x27;</span><span class="r17">,</span><span class="r14">       </span>  
 <span class="r10">  175 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        default</span><span class="r21">=</span><span class="r16">None</span><span class="r17">,</span><span class="r14">             </span>  
 <span class="r10">  176 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        </span><span class="r23">type</span><span class="r21">=</span><span class="r23">str</span><span class="r17">,</span><span class="r14">                 </span>  
 <span class="r10">  177 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        required</span><span class="r21">=</span><span class="r16">False</span><span class="r17">,</span><span class="r14">           </span>  
 <span class="r10">  178 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        help</span><span class="r21">=</span><span class="r22">&quot;directory to save mo</span>  
 <span class="r10">  179 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">                        )</span><span class="r14">                         </span>  
 <span class="r10">  180 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">  181 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    main(parser</span><span class="r21">.</span><span class="r17">parse_args())</span><span class="r14">                     </span>  
 <span class="r10">  182 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">      </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│                                                    
╶──────┼───────┼───────┼───────┼───────┼───────┼───────┼──────────────┼───────┼───────────────────────────────────────────────────╴
 <span class="r10">      </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r27">function summary for run_benchmarks.py            </span>  
 <span class="r10">   33 </span>│<span class="r11">    4% </span>│<span class="r11">       </span>│<span class="r11">  88%  </span>│<span class="r12">       </span>│<span class="r1">  38%  </span>│<span class="r1">   44M </span>│<span class="r1">███████▇▇  3… </span>│<span class="r12">     1 </span>│<span class="r17">main</span><span class="r14">                                              </span>  
       ╵       ╵       ╵       ╵       ╵       ╵       ╵              ╵       ╵                                                    
Top net memory consumption, by line:
<span class="r1">(1)    20:    24 MB</span>                                                                                                                 
<span class="r1">(2)    49:    24 MB</span>                                                                                                                 
<span class="r1">(3)    51:    15 MB</span>                                                                                                                 
<span class="r1">(4)    19:    10 MB</span>                                                                                                                 
<span class="r1">(5)    50:     6 MB</span>                                                                                                                 
<span class="r28">                /ws2/yfulwani/intelligent-indexing/src/utils/preprocessing.py: % of time =   5.67% out of  23.20s.                 </span>
       ╷       ╷       ╷       ╷       ╷       ╷       ╷              ╷       ╷                                                    
 <span class="r2">      </span>│<span class="r3">Time</span><span class="r2">   </span>│<span class="r3">––––––</span><span class="r2"> </span>│<span class="r3">––––––</span><span class="r2"> </span>│<span class="r4">––––––</span><span class="r2"> </span>│<span class="r5">Memory</span><span class="r2"> </span>│<span class="r5">––––––</span><span class="r2"> </span>│<span class="r5">–––––––––––</span><span class="r2">   </span>│<span class="r4">Copy</span><span class="r2">   </span>│<span class="r2">                                                   </span> 
 <span class="r2"> </span><span class="r6">Line</span><span class="r2"> </span>│<span class="r7">Python</span><span class="r2"> </span>│<span class="r7">native</span><span class="r2"> </span>│<span class="r7">system</span><span class="r2"> </span>│<span class="r8">GPU</span><span class="r2">    </span>│<span class="r9">Python</span><span class="r2"> </span>│<span class="r9">net</span><span class="r2">    </span>│<span class="r9">timeline</span><span class="r5">/%</span><span class="r2">    </span>│<span class="r8">(MB/s)</span><span class="r2"> </span>│<span class="r2">/ws2/yfulwani/intelligent-indexing/src/utils/prep… </span> 
╺━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━┿━━━━━━━━━━━━━━┿━━━━━━━┿━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸
 <span class="r10">    1 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r13"># !/usr/bin/env python3</span><span class="r14">                           </span>  
 <span class="r10">    2 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r13"># -*- coding: utf-8 -*-</span><span class="r14">                           </span>  
 <span class="r10">    3 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">    4 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r13"># Copyright (C) 2022 Intel Corporation</span><span class="r14">            </span>  
 <span class="r10">    5 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r13"># SPDX-License-Identifier: BSD-3-Clause</span><span class="r14">           </span>  
 <span class="r10">    6 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">    7 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r13"># pylint: disable=C0415,E0401,R0914</span><span class="r14">               </span>  
 <span class="r10">    8 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">    9 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">&quot;&quot;&quot;</span><span class="r14">                                               </span>  
 <span class="r10">   10 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">Helper functions for preprocessing</span><span class="r14">                </span>  
 <span class="r10">   11 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">&quot;&quot;&quot;</span><span class="r14">                                               </span>  
 <span class="r10">   12 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   13 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r16">import</span><span class="r17"> </span><span class="r18">re</span><span class="r14">                                         </span>  
 <span class="r10">   14 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r16">from</span><span class="r17"> </span><span class="r18">typing</span><span class="r17"> </span><span class="r16">import</span><span class="r17"> List</span><span class="r14">                           </span>  
 <span class="r10">   15 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   16 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">  14%  </span>│<span class="r1">   18M </span>│<span class="r1">▁▁▁▁  15%     </span>│<span class="r12">     1 </span>│<span class="r16">import</span><span class="r17"> </span><span class="r18">nltk</span><span class="r14">                                       </span>  
 <span class="r10">   17 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r16">from</span><span class="r17"> </span><span class="r18">nltk.tokenize</span><span class="r17"> </span><span class="r16">import</span><span class="r17"> word_tokenize</span><span class="r14">           </span>  
 <span class="r10">   18 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r16">from</span><span class="r17"> </span><span class="r18">nltk.corpus</span><span class="r17"> </span><span class="r16">import</span><span class="r17"> stopwords</span><span class="r14">                 </span>  
 <span class="r10">   19 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r16">from</span><span class="r17"> </span><span class="r18">nltk.stem</span><span class="r17"> </span><span class="r16">import</span><span class="r17"> PorterStemmer</span><span class="r14">               </span>  
 <span class="r10">   20 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r16">from</span><span class="r17"> </span><span class="r18">nltk.util</span><span class="r17"> </span><span class="r16">import</span><span class="r17"> ngrams</span><span class="r14">                      </span>  
 <span class="r10">   21 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   22 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r13"># Ensure that the required NLTK libraries are down</span>  
 <span class="r10">   23 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">   4%  </span>│<span class="r12">       </span>│<span class="r1">   7%  </span>│<span class="r1">    2M </span>│<span class="r1">▁▁▁▁▁   7%    </span>│<span class="r12">       </span>│<span class="r17">nltk</span><span class="r21">.</span><span class="r17">download(</span><span class="r22">&#x27;punkt&#x27;</span><span class="r17">)</span><span class="r14">                            </span>  
 <span class="r10">   24 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">nltk</span><span class="r21">.</span><span class="r17">download(</span><span class="r22">&#x27;stopwords&#x27;</span><span class="r17">)</span><span class="r14">                        </span>  
 <span class="r10">   25 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   26 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">    0M </span>│<span class="r1">▁             </span>│<span class="r12">       </span>│<span class="r17">stop_words </span><span class="r21">=</span><span class="r17"> </span><span class="r23">set</span><span class="r17">(stopwords</span><span class="r21">.</span><span class="r17">words(</span><span class="r22">&#x27;english&#x27;</span><span class="r17">))</span><span class="r14">      </span>  
 <span class="r10">   27 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">stemmer </span><span class="r21">=</span><span class="r17"> PorterStemmer()</span><span class="r14">                         </span>  
 <span class="r10">   28 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   29 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   30 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r16">def</span><span class="r17"> </span><span class="r19">clean_headline</span><span class="r17">(headline: </span><span class="r23">str</span><span class="r17">) </span><span class="r21">-&gt;</span><span class="r17"> </span><span class="r23">str</span><span class="r17">:</span><span class="r14">         </span>  
 <span class="r10">   31 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r20">    </span><span class="r15">&quot;&quot;&quot;cleans the headline field</span><span class="r14">                  </span>  
 <span class="r10">   32 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   33 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">    Args:</span><span class="r14">                                         </span>  
 <span class="r10">   34 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">        headline (str): headline associated with a</span>  
 <span class="r10">   35 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   36 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">    Returns:</span><span class="r14">                                      </span>  
 <span class="r10">   37 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">        str: cleaned headline</span><span class="r14">                     </span>  
 <span class="r10">   38 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">    &quot;&quot;&quot;</span><span class="r14">                                           </span>  
 <span class="r10">   39 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    headline </span><span class="r21">=</span><span class="r17"> headline</span><span class="r21">.</span><span class="r17">lower()</span><span class="r14">                   </span>  
 <span class="r10">   40 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    headline </span><span class="r21">=</span><span class="r17"> re</span><span class="r21">.</span><span class="r17">sub(</span><span class="r22">r&quot;[^\w]&quot;</span><span class="r17">, </span><span class="r22">&quot; &quot;</span><span class="r17">, headline)</span><span class="r14">    </span>  
 <span class="r10">   41 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    </span><span class="r16">return</span><span class="r17"> headline</span><span class="r14">                               </span>  
 <span class="r10">   42 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   43 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   44 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r16">def</span><span class="r17"> </span><span class="r19">clean_link</span><span class="r17">(link: </span><span class="r23">str</span><span class="r17">) </span><span class="r21">-&gt;</span><span class="r17"> </span><span class="r23">str</span><span class="r17">:</span><span class="r14">                 </span>  
 <span class="r10">   45 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r20">    </span><span class="r15">&quot;&quot;&quot;cleans the hyperlink field</span><span class="r14">                 </span>  
 <span class="r10">   46 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   47 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">    Args:</span><span class="r14">                                         </span>  
 <span class="r10">   48 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">        link (str): hyperlink associated with an a</span>  
 <span class="r10">   49 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   50 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">    Returns:</span><span class="r14">                                      </span>  
 <span class="r10">   51 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">        str: cleaned hyperlink</span><span class="r14">                    </span>  
 <span class="r10">   52 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">    &quot;&quot;&quot;</span><span class="r14">                                           </span>  
 <span class="r10">   53 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    link </span><span class="r21">=</span><span class="r17"> link</span><span class="r21">.</span><span class="r17">lower()</span><span class="r14">                           </span>  
 <span class="r10">   54 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    link </span><span class="r21">=</span><span class="r17"> link</span><span class="r21">.</span><span class="r17">replace(</span><span class="r22">&quot;https://www.huffingtonpos</span>  
 <span class="r10">   55 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    link </span><span class="r21">=</span><span class="r17"> re</span><span class="r21">.</span><span class="r17">sub(</span><span class="r14">                                </span>  
 <span class="r10">   56 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        </span><span class="r22">r&#x27;https://www.huffingtonpost.com&#x27;</span><span class="r14">         </span>  
 <span class="r10">   57 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        </span><span class="r22">r&#x27;https?://|www\d{0,3}[.][a-z0-9.\-]+[.]co</span>  
 <span class="r10">   58 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        </span><span class="r22">&quot;&quot;</span><span class="r17">,</span><span class="r14">                                       </span>  
 <span class="r10">   59 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">        link</span><span class="r14">                                      </span>  
 <span class="r10">   60 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    )</span><span class="r14">                                             </span>  
 <span class="r10">   61 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    link </span><span class="r21">=</span><span class="r17"> re</span><span class="r21">.</span><span class="r17">sub(</span><span class="r22">r&quot;(\W|_)+&quot;</span><span class="r17">, </span><span class="r22">&quot; &quot;</span><span class="r17">, link)</span><span class="r14">          </span>  
 <span class="r10">   62 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   63 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    link </span><span class="r21">=</span><span class="r17"> re</span><span class="r21">.</span><span class="r17">sub(</span><span class="r22">r&quot;[^\w]&quot;</span><span class="r17">, </span><span class="r22">&quot; &quot;</span><span class="r17">, link)</span><span class="r14">            </span>  
 <span class="r10">   64 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    link </span><span class="r21">=</span><span class="r17"> link</span><span class="r21">.</span><span class="r17">replace(</span><span class="r22">&quot;html&quot;</span><span class="r17">, </span><span class="r22">&quot; &quot;</span><span class="r17">)</span><span class="r14">              </span>  
 <span class="r10">   65 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    link </span><span class="r21">=</span><span class="r17"> re</span><span class="r21">.</span><span class="r17">sub(</span><span class="r22">r&quot;\b[a-zA-Z]\b&quot;</span><span class="r17">, </span><span class="r22">&quot;&quot;</span><span class="r17">, link)</span><span class="r21">.</span><span class="r17">strip</span>  
 <span class="r10">   66 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    </span><span class="r16">return</span><span class="r17"> </span><span class="r22">&quot; &quot;</span><span class="r21">.</span><span class="r17">join(link</span><span class="r21">.</span><span class="r17">strip()</span><span class="r21">.</span><span class="r17">split()[:</span><span class="r21">-1</span><span class="r17">])</span><span class="r14">    </span>  
 <span class="r10">   67 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   68 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   69 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r16">def</span><span class="r17"> </span><span class="r19">clean_short_description</span><span class="r17">(short_description: </span><span class="r23">str</span>  
 <span class="r10">   70 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r20">    </span><span class="r15">&quot;&quot;&quot;cleans the short description field</span><span class="r14">         </span>  
 <span class="r10">   71 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   72 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">    Args:</span><span class="r14">                                         </span>  
 <span class="r10">   73 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">        short_description (str): short description</span>  
 <span class="r10">   74 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   75 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">    Returns:</span><span class="r14">                                      </span>  
 <span class="r10">   76 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">        str: cleaned short description</span><span class="r14">            </span>  
 <span class="r10">   77 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">    &quot;&quot;&quot;</span><span class="r14">                                           </span>  
 <span class="r10">   78 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    short_description </span><span class="r21">=</span><span class="r17"> short_description</span><span class="r21">.</span><span class="r17">lower()</span><span class="r14"> </span>  
 <span class="r10">   79 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    short_description </span><span class="r21">=</span><span class="r17"> re</span><span class="r21">.</span><span class="r17">sub(</span><span class="r22">r&quot;[^\w]&quot;</span><span class="r17">, </span><span class="r22">&quot; &quot;</span><span class="r17">, shor</span>  
 <span class="r10">   80 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    </span><span class="r16">return</span><span class="r17"> short_description</span><span class="r14">                      </span>  
 <span class="r10">   81 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   82 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   83 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r16">def</span><span class="r17"> </span><span class="r19">tokenize</span><span class="r17">(text: </span><span class="r23">str</span><span class="r17">) </span><span class="r21">-&gt;</span><span class="r17"> List[</span><span class="r23">str</span><span class="r17">]:</span><span class="r14">             </span>  
 <span class="r10">   84 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r20">    </span><span class="r15">&quot;&quot;&quot;turns a body of text into a collection of t</span>  
 <span class="r10">   85 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   86 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">    Args:</span><span class="r14">                                         </span>  
 <span class="r10">   87 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">        text (str): the body of text to tokenize</span><span class="r14">  </span>  
 <span class="r10">   88 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
 <span class="r10">   89 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">    Returns:</span><span class="r14">                                      </span>  
 <span class="r10">   90 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">        List[str] : collection of tokens</span><span class="r14">          </span>  
 <span class="r10">   91 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r15">    &quot;&quot;&quot;</span><span class="r14">                                           </span>  
 <span class="r10">   92 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    tokens </span><span class="r21">=</span><span class="r17"> word_tokenize(text)</span><span class="r14">                  </span>  
 <span class="r10">   93 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    tokens </span><span class="r21">=</span><span class="r17"> [stemmer</span><span class="r21">.</span><span class="r17">stem(tk) </span><span class="r16">for</span><span class="r17"> tk </span><span class="r24">in</span><span class="r17"> tokens]</span><span class="r14">  </span>  
 <span class="r10">   94 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    tokens </span><span class="r21">=</span><span class="r17"> [tk </span><span class="r16">for</span><span class="r17"> tk </span><span class="r24">in</span><span class="r17"> tokens </span><span class="r16">if</span><span class="r17"> tk </span><span class="r24">not</span><span class="r17"> </span><span class="r24">in</span><span class="r17"> sto</span>  
 <span class="r10">   95 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    n_grams </span><span class="r21">=</span><span class="r17"> ngrams(tokens, </span><span class="r21">2</span><span class="r17">)</span><span class="r14">                   </span>  
 <span class="r10">   96 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    tokens </span><span class="r21">=</span><span class="r17"> tokens </span><span class="r21">+</span><span class="r17"> [</span><span class="r22">&#x27; &#x27;</span><span class="r21">.</span><span class="r17">join(grams) </span><span class="r16">for</span><span class="r17"> grams </span><span class="r24">i</span>  
 <span class="r10">   97 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r17">    </span><span class="r16">return</span><span class="r17"> tokens</span><span class="r14">                                 </span>  
 <span class="r10">   98 </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r11">       </span>│<span class="r12">       </span>│<span class="r1">       </span>│<span class="r1">       </span>│<span class="r1">              </span>│<span class="r12">       </span>│<span class="r14">                                                  </span>  
       ╵       ╵       ╵       ╵       ╵       ╵       ╵              ╵       ╵                                                    
Top net memory consumption, by line:
<span class="r1">(1)    16:    18 MB</span>                                                                                                                 
<span class="r1">(2)    23:     2 MB</span>                                                                                                                 
generated by the <a class="r29" href="https://github.com/plasma-umass/scalene">scalene</a> profiler                                                                                                   
</code></pre>
</body>
</html>
